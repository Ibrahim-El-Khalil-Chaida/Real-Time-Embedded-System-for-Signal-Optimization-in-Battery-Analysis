Version 4
SHEET 1 3200 852
WIRE 576 -48 512 -48
WIRE 768 -48 656 -48
WIRE 192 -32 -672 -32
WIRE 1216 16 1152 16
WIRE 1376 16 1296 16
WIRE 1408 16 1376 16
WIRE 1552 16 1488 16
WIRE 512 48 512 -48
WIRE 512 48 464 48
WIRE 2736 48 2736 -16
WIRE -448 64 -800 64
WIRE 2128 64 2112 64
WIRE 2240 64 2208 64
WIRE 192 80 192 -32
WIRE 192 80 128 80
WIRE 192 96 192 80
WIRE 512 112 512 48
WIRE 640 112 512 112
WIRE 768 128 768 -48
WIRE 768 128 704 128
WIRE 832 128 768 128
WIRE 1376 128 1376 16
WIRE 1376 128 1296 128
WIRE 1424 128 1376 128
WIRE 496 144 464 144
WIRE 640 144 496 144
WIRE 1552 144 1552 16
WIRE 1552 144 1488 144
WIRE 1648 144 1552 144
WIRE -928 160 -1056 160
WIRE -800 160 -800 64
WIRE -800 160 -848 160
WIRE -768 160 -800 160
WIRE -672 160 -672 -32
WIRE -672 160 -688 160
WIRE -656 160 -672 160
WIRE -512 160 -576 160
WIRE -448 160 -448 64
WIRE -432 160 -448 160
WIRE 2112 160 2112 64
WIRE 2112 160 2064 160
WIRE 2128 160 2112 160
WIRE 2240 176 2240 64
WIRE 2240 176 2368 96
WIRE 2240 176 2192 176
WIRE 2592 176 2576 176
WIRE 2736 176 2736 128
WIRE 2736 176 2656 176
WIRE 2832 176 2736 176
WIRE -432 192 -464 192
WIRE -320 208 -368 208
WIRE 192 208 192 176
WIRE -432 224 -448 224
WIRE 2736 224 2736 176
WIRE 496 272 496 224
WIRE -928 304 -1056 304
WIRE -800 304 -848 304
WIRE -784 304 -800 304
WIRE -512 304 -512 160
WIRE -512 304 -704 304
WIRE -320 304 -320 208
WIRE -320 304 -512 304
WIRE 192 304 192 288
WIRE 192 304 128 304
WIRE -800 368 -800 304
WIRE -464 368 -464 192
WIRE -464 368 -800 368
WIRE -448 368 -448 224
WIRE 192 368 192 304
WIRE 2256 384 2256 336
WIRE 608 416 544 416
WIRE 800 416 688 416
WIRE 1648 416 1616 416
WIRE 1744 416 1728 416
WIRE -448 496 -448 448
WIRE 544 496 544 416
WIRE 688 496 544 496
WIRE 2256 496 2256 464
WIRE 2256 496 2208 496
WIRE 2352 496 2256 496
WIRE 416 512 384 512
WIRE 544 512 544 496
WIRE 544 512 496 512
WIRE 800 512 800 416
WIRE 800 512 752 512
WIRE 944 512 800 512
WIRE 1456 512 1392 512
WIRE 1616 512 1616 416
WIRE 1616 512 1536 512
WIRE 1632 512 1616 512
WIRE 688 528 672 528
WIRE 1744 528 1744 416
WIRE 1744 528 1696 528
WIRE 1776 528 1744 528
WIRE 2256 528 2256 496
WIRE 416 608 384 608
WIRE 528 608 496 608
WIRE 672 608 672 528
WIRE 672 608 528 608
WIRE -864 672 -864 624
WIRE -976 688 -976 624
WIRE 192 688 192 448
WIRE 528 736 528 688
WIRE -976 752 -976 688
WIRE -864 752 -864 672
WIRE -704 752 -704 656
FLAG 192 688 0
FLAG 672 96 vs+
FLAG 672 160 vs-
FLAG -864 832 0
FLAG -976 832 0
FLAG -864 672 vs-
FLAG -976 688 vs+
FLAG 496 272 0
FLAG 384 48 bat-
FLAG 128 80 bat+
FLAG 128 304 bat-
FLAG 384 144 bat+
FLAG 720 480 vs+
FLAG 720 544 vs-
FLAG 528 736 0
FLAG 384 512 0
FLAG 384 608 bat-
FLAG -368 176 vs+
FLAG -368 144 vs-
FLAG -1056 240 0
FLAG -1056 384 0
FLAG -448 496 vs-
FLAG 832 128 volt_measur_1
FLAG 944 512 curr_measur_1
FLAG 1216 128 volt_measur_1
FLAG 1456 112 vs+
FLAG 1456 176 vs-
FLAG 1424 160 0
FLAG 1152 -64 0
FLAG 1648 144 volt_measur_2
FLAG 1984 160 volt_measur_2
FLAG 2160 144 vs+
FLAG 2160 208 vs-
FLAG 2128 192 0
FLAG 2736 304 0
FLAG 2368 96 volt_measur_3
FLAG 2576 176 volt_measur_3
FLAG 2832 176 volt_measur_4
FLAG 1392 512 curr_measur_1
FLAG 1664 496 vs+
FLAG 1664 560 vs-
FLAG 1632 544 0
FLAG 1776 528 curr_measur_2
FLAG -704 832 0
FLAG -704 656 vOffset
FLAG 2736 -16 vOffset
FLAG 2256 336 vOffset
FLAG 2256 608 0
FLAG 2144 496 curr_measur_2
FLAG 2352 496 curr_measur_3
SYMBOL voltage 192 80 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 3.7
SYMBOL res 176 192 R0
SYMATTR InstName R1
SYMATTR Value 10m
SYMBOL res 176 352 R0
SYMATTR InstName Rshunt
SYMATTR Value 100m
SYMBOL voltage -864 736 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value -12
SYMBOL voltage -976 736 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 12
SYMBOL res 480 128 R0
SYMATTR InstName R2
SYMATTR Value 100k
SYMBOL res 480 128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 100k
SYMBOL res 672 -64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 100k
SYMBOL res 480 32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 100k
SYMBOL res 512 592 R0
SYMATTR InstName R6
SYMATTR Value 100k
SYMBOL res 512 592 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 100k
SYMBOL res 704 400 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 100k
SYMBOL res 512 496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 100k
SYMBOL AutoGenerated\\OPA548 -400 192 R0
SYMATTR InstName U3
SYMBOL res -672 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 10k
SYMBOL res -688 288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL res -832 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 10k
SYMBOL res -832 288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 10k
SYMBOL res -560 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 4
SYMBOL voltage -1056 288 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 1.65
SYMBOL voltage -1056 144 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value SINE(1.65 1 10)
SYMBOL res -464 352 R0
SYMATTR InstName R16
SYMATTR Value 33k
SYMBOL OpAmps\\ADA4522 720 448 R0
SYMATTR InstName U5
SYMBOL OpAmps\\ADA4522 672 64 R0
WINDOW 3 11 122 Left 2
SYMATTR InstName U6
SYMBOL res 1312 112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 100k
SYMBOL res 1312 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 100k
SYMBOL voltage 1152 -80 R0
SYMATTR InstName V6
SYMATTR Value 3.7
SYMBOL OpAmps\\ADA4522 1456 80 R0
WINDOW 3 11 122 Left 2
SYMATTR InstName U1
SYMBOL res 1504 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R18
SYMATTR Value 100k
SYMBOL res 2080 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 1k
SYMBOL res 2224 48 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 600k
SYMBOL OpAmps\\ADA4522 2160 112 R0
WINDOW 3 11 122 Left 2
SYMATTR InstName U2
SYMBOL cap 2656 160 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 10µ
SYMBOL res 2720 32 R0
SYMATTR InstName R21
SYMATTR Value 100k
SYMBOL res 2720 208 R0
SYMATTR InstName R22
SYMATTR Value 100k
SYMBOL res 1552 496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value 1k
SYMBOL res 1744 400 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R24
SYMATTR Value 60k
SYMBOL OpAmps\\ADA4522 1664 464 R0
WINDOW 3 11 122 Left 2
SYMATTR InstName U4
SYMBOL res 2240 368 R0
SYMATTR InstName R25
SYMATTR Value 100k
SYMBOL res 2240 512 R0
SYMATTR InstName R26
SYMATTR Value 100k
SYMBOL cap 2208 480 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 10µ
SYMBOL voltage -704 736 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V7
SYMATTR Value 3.3
TEXT -384 712 Left 2 !.tran 0 0.6 0.1 0.00001
TEXT -1424 -56 Left 2 ;* 1 = NON-INVERTING INPUT\n* 2 = INVERTING INPUT\n* 3 = CURRENT LIMIT\n* 4 = NEGATIVE RAIL\n* 5 = POSITIVE RAIL\n* 6 = OUTPUT\n* 7 = ENABLE/STATUS
